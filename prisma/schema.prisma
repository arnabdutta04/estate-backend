// ===============================
// GENERATOR & DATASOURCE
// ===============================
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ===============================
// ENUMS
// ===============================
enum Role {
  CUSTOMER
  BROKER
  ADMIN
}

enum PropertyType {
  APARTMENT
  VILLA
  HOUSE
  FLAT
  COMMERCIAL
  LAND
}

enum ListingType {
  SALE
  RENT
}

enum Furnished {
  FULLY
  SEMI
  UNFURNISHED
}

enum Condition {
  NEW
  EXCELLENT
  GOOD
  FAIR
  NEEDS_RENOVATION
}

enum Status {
  AVAILABLE
  SOLD
  RENTED
  PENDING
}

enum Specialization {
  RESIDENTIAL
  COMMERCIAL
  INDUSTRIAL
  AGRICULTURAL
}

// ===============================
// USER MODEL (from Sequelize User.js)
// ===============================
model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  phone     String
  role      Role     @default(CUSTOMER)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  properties Property[]
  broker     Broker?
}

// ===============================
// BROKER MODEL (from Mongo Broker.js)
// ===============================
model Broker {
  id             Int      @id @default(autoincrement())
  userId         Int      @unique
  company        String
  licenseNumber  String   @unique
  experience     Int
  rating         Float    @default(0)
  totalReviews   Int      @default(0)
  specialization Specialization[]
  servingAreas   String[]
  verified       Boolean  @default(false)

  user        User       @relation(fields: [userId], references: [id])
  properties  Property[]
}

// ===============================
// PROPERTY MODEL (from Sequelize Property.js)
// ===============================
model Property {
  id            Int        @id @default(autoincrement())
  title         String
  description   String

  propertyType  PropertyType
  listingType   ListingType

  price         Decimal    @db.Decimal(10,2)

  // Location
  address       String
  city          String
  state         String
  pincode       String
  latitude      Float?
  longitude     Float?

  // Specifications
  bedrooms      Int
  bathrooms     Int
  area          Decimal    @db.Decimal(10,2)
  floors        Int?
  furnished     Furnished  @default(UNFURNISHED)
  yearBuilt     Int
  condition     Condition

  features      String[]
  images        String[]

  status        Status     @default(AVAILABLE)
  views         Int        @default(0)
  featured      Boolean    @default(false)

  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt

  // Relations
  userId        Int
  user          User       @relation(fields: [userId], references: [id])

  brokerId      Int?
  broker        Broker?    @relation(fields: [brokerId], references: [id])
}
